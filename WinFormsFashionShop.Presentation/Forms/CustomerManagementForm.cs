using System;
using System.Windows.Forms;
using WinFormsFashionShop.Business.Services;
using WinFormsFashionShop.Data.Entities;
using System.Collections.Generic;

namespace WinFormsFashionShop.Presentation.Forms
{
    public class CustomerManagementForm : Form    {        private readonly ICustomerService _customerService;        private DataGridView _grid = new DataGridView { Dock = DockStyle.Top, Height = 400 };        private Button _btnRefresh = new Button { Text = "Refresh" };        private Button _btnAdd = new Button { Text = "Add" };        public CustomerManagementForm(ICustomerService customerService)        {            _customerService = customerService ?? throw new ArgumentNullException(nameof(customerService));            Text = "Customer Management";            Width = 900;            Height = 600;            InitializeControls();            LoadCustomersIntoGrid();        }        private void InitializeControls()        {            _btnRefresh.Top = 420; _btnRefresh.Left = 20; _btnRefresh.Click += OnRefreshClicked;            _btnAdd.Top = 420; _btnAdd.Left = 120; _btnAdd.Click += OnAddClicked;            Controls.Add(_grid);            Controls.Add(_btnRefresh);            Controls.Add(_btnAdd);        }        private void OnRefreshClicked(object? sender, EventArgs e)        {            LoadCustomersIntoGrid();        }        private void OnAddClicked(object? sender, EventArgs e)        {            var customer = new Customer { FullName = "New Customer" };            try            {                _customerService.CreateCustomer(customer);                LoadCustomersIntoGrid();            }            catch (Exception ex)            {                MessageBox.Show($"Error adding customer: {ex.Message}", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);            }        }        private void LoadCustomersIntoGrid()        {            try            {                var customers = _customerService.GetAllCustomers();                var list = new List<Customer>(customers);                _grid.DataSource = list;            }            catch (Exception ex)            {                MessageBox.Show($"Failed to load customers: {ex.Message}", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);            }        }    }}