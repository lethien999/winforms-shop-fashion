using System;
using System.Windows.Forms;
using WinFormsFashionShop.Business.Services;

namespace WinFormsFashionShop.Presentation.Forms
{
    public class MainForm : Form
    {
        private readonly IProductService _productService;        private readonly ICustomerService _customerService;        private readonly IOrderService _orderService;        private readonly IInventoryService _inventoryService;        public MainForm(IProductService productService, ICustomerService customerService, IOrderService orderService, IInventoryService inventoryService)        {            _productService = productService ?? throw new ArgumentNullException(nameof(productService));            _customerService = customerService ?? throw new ArgumentNullException(nameof(customerService));            _orderService = orderService ?? throw new ArgumentNullException(nameof(orderService));            _inventoryService = inventoryService ?? throw new ArgumentNullException(nameof(inventoryService));            Text = "WinForms Fashion Shop";            Width = 1200;            Height = 800;            InitializeMenu();        }        private void InitializeMenu()        {            var menu = new MenuStrip();            var manageMenu = new ToolStripMenuItem("Manage");            var productsMenu = new ToolStripMenuItem("Products");            productsMenu.Click += (s, e) => OpenProductManagement();            var customersMenu = new ToolStripMenuItem("Customers");            customersMenu.Click += (s, e) => OpenCustomerManagement();            var ordersMenu = new ToolStripMenuItem("Orders");            ordersMenu.Click += (s, e) => OpenOrderManagement();            var reportsMenu = new ToolStripMenuItem("Reports");            reportsMenu.Click += (s, e) => OpenReports();            manageMenu.DropDownItems.Add(productsMenu);            manageMenu.DropDownItems.Add(customersMenu);            manageMenu.DropDownItems.Add(ordersMenu);            manageMenu.DropDownItems.Add(reportsMenu);            menu.Items.Add(manageMenu);            Controls.Add(menu);        }        private void OpenProductManagement()        {            var frm = new ProductManagementForm(_productService);            frm.ShowDialog(this);        }        private void OpenCustomerManagement()        {            var frm = new CustomerManagementForm(_customerService);            frm.ShowDialog(this);        }        private void OpenOrderManagement()        {            var frm = new OrderForm(_orderService, _productService, _customerService, _inventoryService);            frm.ShowDialog(this);        }        private void OpenReports()        {            var frm = new ReportForm();            frm.ShowDialog(this);        }    }}